<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
<style type="text/css">
table {
   border-collapse: collapse;
   border-width: 1px;
   border-spacing: 1px;
   border-color: transparent;
   margin: 16px 0;
   width: 100%;
}
th {
   background-color: #bbb; color: white;
}
td, th {
   border-style: solid;
   border-color: black;
   border-width: 1px;
   padding: 0 6px;
}
td p:first-child, th p:first-child {
   margin-top: 3px;
}
td p:last-child, th p:last-child {
   margin-bottom: 3px;
}

.smarkdoc {
  margin-left: 42px; margin-right: 42px;
  font-size: 13px;
  font-family: 'Lucida Grande', Geneva, Helvetica, Arial, sans-serif;
}

h1, h2, h3 { color: #3c4c6c; }
h1 {
  text-align: center;
  font-size: 200%;
/*    margin-left: -30px; */
  clear: both;
}
h2 {
  font-size: 160%;
  margin: 32px -40px 24px -42px;
  padding: 3px 24px 8px;
  border-bottom: 2px solid #5088c5;
  clear: both;
}
h3 {
  font-size: 130%;
  margin: 20px -4px 10px;
  padding: 4px;
  clear: both;
}
h4 {
  font-size: 110%;
  margin: 2em 0 1em;
}

pre {
  font-size: 90%;
  background-color: #f0f0f4; padding: 6px; border: 1px solid #d0d0ee;
  font-family: "Courier New", "Lucida Console", "Monaco", monospace;
}

.pre {
  font-size: 90%;
  padding: 6px;
  background-color: #f0f0f4;
  font-family: "Courier New", "Lucida Console", "Monaco", monospace;
}

code {
  font-size: 90%;
  font-family: "Courier New", "Lucida Console", "Monaco", monospace;
}

h3 code {
  font-size: 100%;
}

p {
  margin: 0.8em 0;
}
ul, ol {
  margin: 1em 0 1em 3em; padding: 0;
}
div.indent {
  margin: 0 3em;
}

a[href] {
  text-decoration: none;
  color: #2020b0;
}
a[href]:hover {
  border-bottom: 1px dotted #2030d0;
}

/* Smark Users Guide */

.codebox {
  padding: 0 1px;  margin-right:1px;
  border:1px solid #d0d0ee;
  background-color: #f0f0f4;
  font-weight: bold;
  font-family: "Courier New", "Lucida Console", "Monaco", monospace;
}

/* ================ Smark-specific classes ================ */

.indent {
  margin: 0 3em;
}

/*
|| Floats affect text flow but not block boundaries, so graphics in a DIV
|| would overlap floats if not for "clear: both"
*/
.diagram {
  margin: 18px 0;
  clear: both;
}

/* ASCII Art */

.art {
  margin-right: auto; margin-left: auto; /* center */
  font-family: Arial, Verdana, "Lucida Console", Monaco, monospace;
  font-weight: bold;
}
.art * {
   border-color: #543;
}
.art .dline, .art .drect {
   border-style: dotted;
}
.art .rect {
   -webkit-box-shadow: 0.2em 0.2em 0.3em rgba(0,0,0,0.3);
   -moz-box-shadow: 0.2em 0.2em 0.3em rgba(0,0,0,0.3);
   box-shadow: 0.2em 0.2em 0.2em #875;
   background-color: #f9faf4; /* #fafff4; #f8f8ec;  */
}
.art .nofx {
   background-color: #f9faf4;
}
.art .round {
   border-radius: 0.6em;
   -webkit-border-radius: 0.6em;
   -moz-border-radius: 0.6em;
}

/* .art .line {  -webkit-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.3); } */

/* Sequence Charts */

.msc {
   font: 11px Verdana, Monaco, "Lucida Console";
   margin-left: auto; margin-right: auto;
   background-color: white;
   /* border: 1px solid #555; */  /* Useful for non-white pages */
}

/* Table of Contents */

.tocLevel {
  margin-left: 2em;
  font-weight: normal;
}
.tocLevel .tocLevel {
  font-size: 90%; /* ...of inherited font size */
  line-height: 150%; /* ...of font size */
}
.toc > .tocLevel {
  font-weight: bold;
  margin: 0.5em 0
}
.toc {
  column-count: 2; column-gap: 2em;
  -moz-column-count: 2; -moz-column-gap: 2em;
  -webkit-column-count: 2; -webkit-column-gap: 2em;
}

/* ordinary text content is in P elements */

td p:first-child, th p:first-child {
   margin-top: 3px;
}
td p:last-child, th p:last-child {
   margin-bottom: 3px;
}
li p:only-child {
  margin-top: 0;
  margin-bottom: 0;
}

/* ================ Print ================ */

@media print {

  @page {
    margin: 0.75in 0.75in;
    size: Letter;
    @bottom {
      content: counter(page);
      vertical-align: top;
      padding-top: 1em;
    }
  }
  h1 { text-align: center;
       margin: 3in 0 20px; }
  h2 { page-break-before: always; }
  h2 { string-set: section content() }
  .toc { margin: 3em -2em }
  .toc a::after {
     font-size: 10px;
     content: leader(' . ') "  " target-counter(attr(href), page);
  }
  table { page-break-inside: avoid; }
}

/* ================  Layout  ================ */
/*
 *  +------------------------+
 *  |         #header        |
 *  +----------+-------------+
 *  | #sidebar |  #content   |
 *  |          |             |
 *  +----------+-------------+
 *
 * CSS padding, border width, and border style (!) affect the actual height
 * (and in turn layout).
 */

#header {
  position: fixed;
  top: 0px;
  height: 32px;
  left: 0px;
  width: 100%;
  padding: 10px 10px 0 0;
}
#sidebar {
  position: fixed;
  top: 42px;
  bottom: 0px;
  left: 0px;
  min-width: 180px;
  overflow: auto;
  border: 1px solid transparent;
  border-width: 0 1px 0 1px;
  padding: 0px 5px 0px 5px;
}
#content {
  position: fixed;
  top: 60px;
  left: 200px;
  bottom: 0px;
  right: 0px;
  overflow: auto;
  -webkit-overflow-scrolling: touch;
  padding: 10px 20px;
  padding-top: 0;
}

/* ================  Styles  ================ */


body {
  font-family: "Lucida Grande", Helvetica, Arial, sans-serif;
  font-size: 16px;
}

#header {
  color: #fff;
  background: #555;
  text-align: center;
  font-size: 25px;
}

#sidebar {
  color: #000;
  background: #eee;
  border-right: 1px solid #bbb;
  text-align: left;
  font-size: 12px;
  line-height: 50%;
}

#sidebar h1 {
  margin: 0 0 0 0;
  border-left: 5px solid transparent;
  text-align: left;
  font-size: 12px;
  /*text-shadow: #fff 1px 0px;*/
  line-height: 1%;
}

#sidebar h2 {
  margin: 2px 0 8px 0;
  border-left: 5px solid transparent;
  text-align: center;
  font-size: 12px;
  /*text-shadow: #fff 1px 0px;*/
  line-height: 1%;
}



#content {
  margin: 0;
  font-size: 13px;
  line-height: 160%;
}

#content h1, #content h2 {
  border-bottom: 2px solid;
  font-size: 1.8em;
  font-weight: normal;
  margin: 2.0em 0px 1.3em 0px;
  padding-bottom: 0.6em;
  text-align: left;
}

#content h3 {
  color: #242220;
  font-size: 1.4em;
  font-weight: normal;
  margin: 2em 0px 0.8em 0px;
  text-shadow: #FFFFFF 0px 1px 1px;
}
#content h4 {
  font-size: 1.2em;
  font-weight: normal;
  margin: 2em 0px 0.5em 0px;
  text-shadow: #FFFFFF 0px 1px 1px;
}

a[href] {
  color: #05c;
  text-decoration: none;
}

#sidebar a {
  /*text-shadow:  1px 1px 2px #fff, -1px -1px #ddd;*/
  line-height: 40%;
}

pre, code {
  font-family: "Courier New", "Lucida Console", "Monaco", monospace;
  font-family: "Monaco", monospace;  font-size: 90%;
  background-color: #f8f8fa;
  border: 1px solid #e4e4ee;
  -webkit-border-radius: 2px;
  -moz-border-radius: 2px;
  border-radius: 2px;
  padding: 1px 0 0 1px;
}

pre {
  padding: 2px 4px;
}

table {
   border-collapse: collapse;
   border-width: 1px;
   border-spacing: 1px;
   border-color: transparent;
   margin: 16px 0;
   width: 100%;
}
th {
   background-color: #bbb; color: white;
}
td, th {
   border-style: solid;
   border-color: black;
   border-width: 1px;
   padding: 0 6px;
}

/* Highlight currently-selected sidebar link */

#sidebar a.thisfile {
  color: #557;
}

/* indentation */

#content {
   padding-left: 60px;
}
#content h1, 
#content h2, 
#content h3, h4 {
    margin-left: -30px;
}

h3 > code {
    font-size: 80%;
}

/* ================ Smark-specific classes ================ */

.indent {
  margin: 0 3em;
}

/*
|| Floats affect text flow but not block boundaries, so graphics in a DIV 
|| would overlap floats if not for "clear: both"
*/
.diagram {
  margin: 18px 0;
  clear: both;
}

/* ASCII Art */

.art {
  margin-right: auto; margin-left: auto; /* center */
  font-family: Arial, Verdana, "Lucida Console", Monaco, monospace;
  font-weight: bold;
}
.art * {
   border-color: #543;
}
.art .dline, .art .drect {
   border-style: dotted;
}
.art .rect {
   -webkit-box-shadow: 0.2em 0.2em 0.3em rgba(0,0,0,0.3);
   -moz-box-shadow: 0.2em 0.2em 0.3em rgba(0,0,0,0.3);
   box-shadow: 0.2em 0.2em 0.2em #875;
   background-color: #f9faf4; /* #fafff4; #f8f8ec;  */
}
.art .nofx {
   background-color: #f9faf4;
}
.art .round {
   border-radius: 0.6em;
   -webkit-border-radius: 0.6em;
   -moz-border-radius: 0.6em;
}

/* Sequence Charts */

.msc {
   font: 11px Verdana, Monaco, "Lucida Console"; 
   margin-left: auto; margin-right: auto;
   background-color: white;
   border: 1px solid #555;
}

/* Table of Contents */

.tocLevel {
  margin-left: 2em;
  font-weight: normal;
}
.tocLevel .tocLevel {
  font-size: 90%; /* ...of inherited font size */
  line-height: 150%; /* ...of font size */
}
/*
.toc > .tocLevel {
  font-weight: bold;
  margin: 0.5em 0
}
*/

.toc {
  column-count: 1; column-gap: 2em;
  -moz-column-count: 1; -moz-column-gap: 2em;
  -webkit-column-count: 1; -webkit-column-gap: 2em; 
   alternate: column-width: 235px; column-rule-width: 5px;
}


.columns {
  column-count: 2; column-gap: 2em;
  -moz-column-count: 2; -moz-column-gap: 2em;
  -webkit-column-count: 2; -webkit-column-gap: 2em; p
}

/* ordinary text content is in P elements */

td p:first-child, th p:first-child {
   margin-top: 3px;
}
td p:last-child, th p:last-child {
   margin-bottom: 3px;
}
li p:only-child {
  margin-top: 0;
  margin-bottom: 0;
}


/* ================ Print ================ */

@media print {

  #header, #content { position: static; }
  #sidebar { display: none; }

  @page {
    margin: 0.75in 0.75in;
    size: Letter;
    @bottom {
      content: counter(page);
      vertical-align: top;
      padding-top: 1em;
    }
  }
  h1 { text-align: center;
       margin: 1in 0 1in; }
  h2 { page-break-before: always; }
  h2 { string-set: section content() }
  .toc { margin: 3em 0 }
  .toc a::after {
     font-size: 10px;
     content: leader(' . ') "  " target-counter(attr(href), page);
  }
  table { page-break-inside: avoid; }
}


</style><style type="text/css">
.search { right: 20pt; position: fixed; top: 5pt }

</style><title>Voice unit testing</title>
</head><body>
<div class="smarkdoc"><div id="header">Hexagon SDK 3.5.4</div><div id="sidebar"><top><img src="../images/sidebar_top.jpg"></top><script src="../scripts/post.js" type="text/javascript"></script><form class="search" id="searchForm"><input id="searchquery" name="q" onkeydown="postFunctionKeydown(event, true)"><input id="searchButton" onclick="postFunction(true)" type="button" value="Search"></form><p>
<a href="../index.html">Quick start</a>
</p><hr>
<p>
<a href="../feature_matrix.html">Feature Matrix</a>
</p><hr>
<p>
<a href="../hexagon_architecture.html">Hexagon Architecture</a>
</p><hr>
<p>
<a href="../images/Hexagon_Document_Bundle.pdf#page=2881">Hexagon Compiler/Linker</a>
</p><hr>
<p>
<a href="../hexagon_libraries.html">Hexagon Standard Libraries</a>
</p><hr>
<p>
<a href="../images/80-VB419-178_QuRT_User_Guide.pdf">Hexagon RTOS</a>
</p><hr>
<p>
<a href="../images/80-VB419-108_Hexagon_DSP_User_Guide.pdf">Hexagon DSP Programming</a>
</p><hr>
<h3>
<a name="Platforms"></a>Platforms
</h3><p>
<a href="../Platforms_HLOS.html">HLOS</a>
</p><p>
<a href="../Platforms_Simulator.html">Simulator</a>
</p><p>
<a href="../Platforms_Target.html">Target</a>
</p><hr>
<h3>
<a name="Environments"></a>Environments
</h3><p>
<a href="../Environments_Build%20System.html">Build System</a>
</p><p>
<a href="../Environments_Build%20System%20Porting.html">Build System Porting</a>
</p><p>
<a href="../Environments_Hexagon%20IDE.html">Hexagon IDE</a>
</p><hr>
<h3>
<a name="ArchitectureOverview"></a>ArchitectureOverview
</h3><p>
<a href="../HVX/ArchitectureOverview.html">HVX</a>
</p><hr>
<h3>
<a name="Applications"></a>Applications
</h3><p>
<a href="../Audio/Applications.html">Audio</a>
</p><p>
<a href="../Camera%20streaming/Applications.html">Camera streaming</a>
</p><p>
<a href="../Applications_Compute%20offload.html">Compute offload</a>
</p><p>
<a href="../FastCV/Applications_Computer%20Vision.html">Computer Vision</a>
</p><p>
<a href="../Neural%20Networks/Applications.html">Neural Networks</a>
</p><p>
<a href="../Voice/Applications.html">Voice</a>
</p><p>
<a href="../Camera%20streaming/Applications_legacy.html">legacy</a>
</p><hr>
<h3>
<a name="APIs"></a>APIs
</h3><p>
<a href="../APIs_Async%20Message%20Queue.html">Async Message Queue</a>
</p><p>
<a href="../APIs_DSP%20Clk%20&amp;%20Rsrc%20Mgmt.html">DSP Clk &amp; Rsrc Mgmt</a>
</p><p>
<a href="../APIs_Dynamic%20Loading.html">Dynamic Loading</a>
</p><p>
<a href="../APIs_FastRPC.html">FastRPC</a>
</p><hr>
<h3>
<a name="Examples"></a>Examples
</h3><p>
<a href="../Audio/Examples.html">Audio</a>
</p><p>
<a href="../Camera%20streaming/Examples.html">Camera streaming</a>
</p><p>
<a href="../Examples_Common.html">Common</a>
</p><p>
<a href="../Examples_ComputeHVX.html">ComputeHVX</a>
</p><p>
<a href="../Examples_GeneralOverview.html">GeneralOverview</a>
</p><p>
<a href="../Neural%20Networks/Examples.html">Neural Networks</a>
</p><p>
<a href="../Camera%20streaming/Examples_legacy.html">legacy</a>
</p><hr>
<h3>
<a name="Testing"></a>Testing
</h3><p>
<a href="../CAPIv2/Testing_CAPIv2%20Unit%20Tests.html">CAPIv2 Unit Tests</a>
</p><p>
<a href="../Testing_Eclipse%20Unit%20Tests.html">Eclipse Unit Tests</a>
</p><hr>
<h3>
<a name="Debugging"></a>Debugging
</h3><p>
<a href="../Debugging_Connect%20to%20Device.html">Connect to Device</a>
</p><p>
<a href="../Debugging_Exceptions.html">Exceptions</a>
</p><p>
<a href="../Debugging_Message%20Logging.html">Message Logging</a>
</p><p>
<a href="../Debugging_Simulator.html">Simulator</a>
</p><p>
<a href="../Debugging_Target.html">Target</a>
</p><hr>
<h3>
<a name="Tools"></a>Tools
</h3><p>
<a href="../Tools_Hexagon%20Tools%208.3.html">Hexagon Tools 8.3</a>
</p><p>
<a href="../Tools_IDL%20Compiler.html">IDL Compiler</a>
</p><p>
<a href="../Tools_On%20Target%20Profiling.html">On Target Profiling</a>
</p><p>
<a href="../Tools_Scripts.html">Scripts</a>
</p><p>
<a href="../Tools_Signing.html">Signing</a>
</p><p>
<a href="../Tools_UserGuides.html">UserGuides</a>
</p><p>
<a href="../Tools_Utilities.html">Utilities</a>
</p><hr>
<h3>
<a name="FAQ"></a>FAQ
</h3><p>
<a href="../FAQ_Common.html">Common</a>
</p><p>
<a href="../FAQ_Dynamic%20Loading.html">Dynamic Loading</a>
</p><p>
<a href="../FAQ_FastRPC.html">FastRPC</a>
</p><p>
<a href="../FAQ_Hexagon%20IDE.html">Hexagon IDE</a>
</p><hr>
<h3>
<a name="Dependencies"></a>Dependencies
</h3><p>
<a href="../Dependencies_Common.html">Common</a>
</p><hr>
<h3>
<a name="Release%20Notes"></a>Release Notes
</h3><p>
<a href="../Release%20Notes_Common.html">Common</a>
</p><hr>
<h3>
<a name="Support"></a>Support
</h3><p>
<a href="../Support_Contact.html">Contact</a>
</p><center><img src="../images/sidebar_bot.jpg"></center></div><div id="content"><a name="_top_" style="display:block;"></a><h1>
<a name="Voice%20unit%20testing"></a>Voice unit testing
</h1><div class="toc"><div class="tocLevel"><a href="#Overview">Overview</a></div><div class="tocLevel"><a href="#Architecture">Architecture</a><div class="tocLevel"><a href="#Support%20libraries">Support libraries</a></div></div><div class="tocLevel"><a href="#CAPI_V2%20unit%20test%20framework">CAPI_V2 unit test framework</a><div class="tocLevel"><div class="tocLevel"><a href="#test_capi_v2">test_capi_v2</a></div></div><div class="tocLevel"><a href="#Test%20configuration%20file">Test configuration file</a><div class="tocLevel"><a href="#ProcessData">ProcessData</a></div><div class="tocLevel"><a href="#SetMediaFormat">SetMediaFormat</a></div><div class="tocLevel"><a href="#SetOutputMediaFormat">SetOutputMediaFormat</a></div><div class="tocLevel"><a href="#SetParamInband">SetParamInband</a></div><div class="tocLevel"><a href="#GetParamInband">GetParamInband</a></div></div></div><div class="tocLevel"><a href="#Unit%20testing%20CAPI_V2%20modules">Unit testing CAPI_V2 modules</a><div class="tocLevel"><a href="#Eclipse%20based">Eclipse based</a></div></div><div class="tocLevel"><a href="#Import%20Hexagon%20SDK%20example%20project%20to%20workspace">Import Hexagon SDK example project to workspace</a></div><div class="tocLevel"><a href="#Build%20the%20project">Build the project</a></div><div class="tocLevel"><a href="#To%20run%20Project.">To run Project.</a></div><div class="tocLevel"><a href="#Debug%20project.">Debug project.</a><div class="tocLevel"><a href="#Command%20line%20based">Command line based</a></div></div></div><h2>
<a name="Overview"></a>Overview
</h2><p>
The Hexagon SDK provides a framework that enables unit testing of created modules. Unit testing can be done using
</p><ol type="1">
<li>
<p>
Eclipse projects Import existing Eclipse project into workspace, compile the project and easily run and debug unit test executable.
</p>
</li><li>
<p>
Quality tests(qtests). qtests are specified like any other target in a project's makefile. They are automatically run as part of the build process to complete the build/test development process. The tests themselves are compiled into Hexagon binaries and run via the Hexagon simulator. Currently qtests are only meant to be run on the Hexagon simulator, not on target.
</p>
</li>
</ol><h2>
<a name="Architecture"></a>Architecture
</h2><h3>
<a name="Support%20libraries"></a>Support libraries
</h3><p>
The SDK provides general unit test support libraries:
</p><ul type="circle">
<li>
<p>
<a href="../Platforms_Simulator.html#test_main">test_main</a>
</p>
</li><li>
<p>
<a href="../Platforms_Simulator.html#test_util">test_util</a>
</p>
</li>
</ul><p>
In addition, the SDK provides Voice specific test support libraries.
</p><ul type="circle">
<li>
<p>
test_capi_v2_voice
</p>
</li><li>
<p>
voice_imc_utils
</p>
</li>
</ul><p>
This library provides a test framework for verifying the functionality of objects that export CAPI_V2. For more information see <a href="#CAPI_V2%20unit%20test%20framework">CAPI_V2 unit test framework</a>
</p><h2>
<a name="CAPI_V2%20unit%20test%20framework"></a>CAPI_V2 unit test framework
</h2><p>
The support library test_capi_v2_voice contains an CAPI_V2 specific test framework that allows for the verification of objects exporting the CAPI_V2 interface. The support library 'voice_imc_utils' contains utility functions to simulate the Intermodule communication. The framework is run by calling the framework's entry point from within a qtest's <a href="../Platforms_Simulator.html#Test%20sources">Test sources</a>. The signature of the entry point is as follows:
</p><pre>capi_v2_err_t test_capi_v2_main(capi_v2_get_static_properties_f get_static_properties_f,
                           capi_v2_init_f init_f,
                           capi_v2_proplist_t* init_set_properties,
                           capi_v2_proplist_t* static_properties,
                           <span style="color: blue">const</span> <span style="color: blue">char</span>* filename_in, <span style="color: blue">const</span> <span style="color: blue">char</span>* filename_out,
                           <span style="color: blue">const</span> <span style="color: blue">char</span>* filename_config)

- get_static_properties_f contain function pointer to the pp module's get_static_properties function.
  This can be obtained by calling dlsyn() in the qtest's [[Test sources]].
  This function is used to get the module's properties statically like memory size requirements and etc.
- init_f contain function pointer to the pp module's initialization function.
  This can be obtained by calling dlsyn() in the qtest's [[Test sources]].
- init_set_properties is used to hold the list of properties to be set at initialization of the module
  Refer CAPI_V2 interface files to find the list of properties supported at initialization
- static_properties is used to hold the list of <span style="color: blue">static</span> properties
- filename_in is the name of an PCM data file that should be processed by the test
- filename_out is the name of the output file generated by processing filename_in.
- filename_config is the [[Test configuration file]] sequence commands to verify the CAPI_V2 module.
</pre><p>
The qtests for Hexagon SDK examples passthru and gain use the CAPI_V2 Test Framework. For more detailed information about how to call it see those example's qtest source files.
</p><p>
Currently the CAPI_V2 Unit Test Framework does not support verification of the output audio file vs a known reference audio file. Future versions of the Hexagon SDK hope to add support for this feature. Until then the verification of the output file is left to the user.
</p><p>
Note: For 'capi_v2_dummy_ecns' example, entry point is from function 'test_capi_v2_main_refport' where an extra parameter is required to send the reference port input.
</p><div class="indent"><p>
The cfg files in the respective data folder differs in 'InputNumberOfPorts', 'SetNumChannelsAndMappingRef' and 'SetNumChannelsAndMapping'. There are seperate cfg files for single, dual and quad microphobe scenarios. Please refer to the cfg files for details.
</p><p>
Similarly, for 'capi_v2_voice_imc' example, entry point is from function 'test_capi_v2_main_imc'. There are seperate cfg files in respective data folder for Tx and Rx modules. Please refer to the cfg files for details.
</p></div><h4>
<a name="test_capi_v2"></a>test_capi_v2
</h4><p>
See the main <a href="../Platforms_Simulator.html#Enabling%20Simulator%20test">unit_test documentation</a>.
</p><h3>
<a name="Test%20configuration%20file"></a>Test configuration file
</h3><p>
Each test is configured using a configuration file. This file contains a list of commands to execute. The test framework reads and executes the commands from the config file sequentially. Note that the commands are case sensitive and should be entered exactly as they appear below.
</p><p>
The test framework supports the following commands and their parameters:
</p><ul type="circle">
<li>
<p>
<a href="#ProcessData">ProcessData</a>
</p><ul type="circle">
<li>
<p>
NumBuffers &lt;number&gt;
</p>
</li>
</ul>
</li><li>
<p>
<a href="#SetMediaFormat">SetMediaFormat</a>
</p><ul type="circle">
<li>
<p>
SetBitstreamFormat &lt;number&gt;
</p>
</li><li>
<p>
SetDataFormat &lt;number&gt;
</p>
</li><li>
<p>
SetBitsPerSample &lt;number&gt;
</p>
</li><li>
<p>
QFactor &lt;number&gt;
</p>
</li><li>
<p>
SetSamplingRate &lt;number&gt;
</p>
</li><li>
<p>
SetIsSigned &lt;number&gt;
</p>
</li><li>
<p>
SetInterleaving &lt;number&gt;
</p>
</li><li>
<p>
SetNumChannelsAndMapping &lt;number&gt;
</p>
</li>
</ul>
</li><li>
<p>
<a href="#SetOutputMediaFormat">SetOutputMediaFormat</a>
</p><ul type="circle">
<li>
<p>
SetBitstreamFormat &lt;number&gt;
</p>
</li><li>
<p>
SetDataFormat &lt;number&gt;
</p>
</li><li>
<p>
SetBitsPerSample &lt;number&gt;
</p>
</li><li>
<p>
QFactor &lt;number&gt;
</p>
</li><li>
<p>
SetSamplingRate &lt;number&gt;
</p>
</li><li>
<p>
SetIsSigned &lt;number&gt;
</p>
</li><li>
<p>
SetInterleaving &lt;number&gt;
</p>
</li><li>
<p>
SetNumChannelsAndMapping &lt;number&gt;
</p>
</li>
</ul>
</li><li>
<p>
<a href="#SetParamInband">SetParamInband</a>
</p><ul type="circle">
<li>
<p>
PayloadSizeInBytes &lt;number&gt;
</p>
</li>
</ul>
</li><li>
<p>
<a href="#GetParamInband">GetParamInband</a>
</p><ul type="circle">
<li>
<p>
PayloadSizeInBytes &lt;number&gt;
</p>
</li><li>
<p>
&lt;payload&gt;
</p>
</li>
</ul>
</li>
</ul><h4>
<a name="ProcessData"></a>ProcessData
</h4><p>
Processes input buffers from the input file to the output file.
</p><p>
This command exercises the pp module's CAPI_V2 methods get_input_required() and process().
</p><p>
e.g.
</p><pre>ProcessData
  NumBuffers 10
</pre><h4>
<a name="SetMediaFormat"></a>SetMediaFormat
</h4><p>
Sets the media parameters for input port. This should be done to verify the correct handling of specific media parameters and also before a call to <a href="#ProcessData">ProcessData</a> to set up the medial parameters to be used during the processing. It sets the CAPI_V2 library with the specified parameters by calling the pp module function set_properties.
</p><p>
e.g.
</p><pre>SetMediaFormat
  SetBitstreamFormat         69029
  SetDataFormat              0
  SetNumChannelsAndMapping   2 1 2
  SetBitsPerSample           16
  QFactor                    0
  SetSamplingRate            48000
  SetIsSigned                1
  SetInterleaving            2
</pre><h4>
<a name="SetOutputMediaFormat"></a>SetOutputMediaFormat
</h4><p>
Sets the media parameters for output port. This should be done to verify the correct handling of specific media parameters and also before a call to <a href="#ProcessData">ProcessData</a> to setup the medial parameters to be used during the processing. It sets the CAPI_V2 library with the specified parameters by calling the pp module function set_properties.
</p><p>
e.g.
</p><pre>SetOutputMediaFormat
  SetBitstreamFormat         69029
  SetDataFormat              0
  SetNumChannelsAndMapping   2 1 2
  SetBitsPerSample           16
  QFactor                    0
  SetSamplingRate            48000
  SetIsSigned                1
  SetInterleaving            2
</pre><h4>
<a name="SetParamInband"></a>SetParamInband
</h4><p>
Sets a parameter value. The information on the parameter and its payload are specified after the PayloadSizeInBytes parameter as illustrated in the example below.
</p><p>
This command exercises the pp module's CAPI_V2 method set_param().
</p><p>
e.g.
</p><pre>SetParamInband
  PayloadSizeInBytes 24
  00 00 00 00    # Data Payload address &lt;msw&gt;
  00 00 00 00    # Data Payload address &lt;lsw&gt;
  00 00 00 00    # mem_map_handle
  18 00 00 00    # Data payload size
  11 11 11 11    # module_id 0x11111111 VOICE_MODULE_DYNAMIC_GAIN_TX_1
  11 10 00 10    # param_id 0x10001011 PARAM_ID_GAIN_CTRL_MASTER_GAIN
  04 00 00 00    # param_size and padding
  00 30 00 00    # payload (Gain value and reserved)
</pre><h4>
<a name="GetParamInband"></a>GetParamInband
</h4><p>
Gets a parameter value. The information on the parameter and its payload are specified after the PayloadSizeInBytes parameter as illustrated in the example below. Note that GetParamInband contains an additional parameter called RefPayloadSizeInBytes that specifies the expected binary value of the received parameter.
</p><p>
This command exercises the pp module's CAPI_V2 method get_param().
</p><p>
e.g.
</p><pre>GetParamInband
   PayloadSizeInBytes 16
   00 00 00 00    # Data Payload address &lt;msw&gt;
   00 00 00 00    # Data Payload address &lt;lsw&gt;
   00 00 00 00    # mem_map_handle
   11 11 11 11    # module_id 0x11111111 VOICE_MODULE_DYNAMIC_GAIN_TX_1
   11 10 00 10    # param_id 0x10001011 PARAM_ID_GAIN_CTRL_MASTER_GAIN
   04 00 00 00
   RefPayloadSizeInBytes 4
   00 30 00 00
</pre><h2>
<a name="Unit%20testing%20CAPI_V2%20modules"></a>Unit testing CAPI_V2 modules
</h2><h3>
<a name="Eclipse%20based"></a>Eclipse based
</h3><h2>
<a name="Import%20Hexagon%20SDK%20example%20project%20to%20workspace"></a>Import Hexagon SDK example project to workspace
</h2><p>
To import the example into your Eclipse workspace, right-click in Project Explorer and select
</p><p>
<code>Import -&gt; C/C++ -&gt; Existing Code as Makefile Project</code>.
</p><left><img src="images/import_makefile_project.png"></left><p>
In the dialog box, specify the following project properties:
</p><ul type="circle">
<li>
<p>
<b>Project name</b> &#8211; <code>capi_v2_gain</code>
</p>
</li><li>
<p>
<b>Project location</b> &#8211; &lt;Hexagon SDK root dir&gt;\examples\audio\capi_v2_gain
</p>
</li><li>
<p>
<b>Toolchain</b> &#8211; select Hexagon LLVM Tool chain
</p>
</li>
</ul><p>
Click on the <code>Finish</code> button to finish importing the project.
</p><left><img src="images/import_capi_v2_gain.png"></left><h2>
<a name="Build%20the%20project"></a>Build the project
</h2><p>
To build the imported project
</p><p>
Right-click on the project , select properties and then C/C++ Build . Under Builder settings, enter the build command as <b>make V=hexagon_Debug_dynamic_toolv83_v60 VERBOSE=1</b> (or enter your target-appropriate build flavor).
</p><p>
While debugging, Debug build flavors are recommended when possible over Release/ReleaseG, to avoid possible confusions caused by the compiler optimizer.
</p><left><img src="images/capi_v2_gain_build_settings.png"></left><p>
Under Behaviour tab set Build textbox to <b>tree</b> and Clean textbox to <b>tree_clean</b>
</p><left><img src="images/capi_v2_gain_build_behaviour.png"></left><p>
Build the project by right-clicking on the project and select Build Project
</p><left><img src="images/capi_v2_gain_build_project.png"></left><h2>
<a name="To%20run%20Project."></a>To run Project.
</h2><p>
To run the project, right-click on the project in Project Explorer and choose <code>Run As -&gt; Run Configuration</code>.
</p><p>
This command displays the <code>Run Configurations</code> dialog box, which enables you to configure the simulator, program arguments, and runtime environment.
</p><p>
Please fill C/C++ Application field with hexagon_Debug_dynamic_toolv83_v60\capi_v2_gain_q
</p><left><img src="images/capi_v2_gain_run_as.png"></left><p>
The dialog box display tabs for configuring the simulator, program arguments, and runtime environment.
</p><p>
To specify the simulator arguments, click on the <code>Simulator</code> tab in the dialog box. For this example please give following options in miscellaneous flag section.
</p><pre>
--simulated_returnval --usefs hexagon_Debug_dynamic_toolv83_v60 --pmu_statsfile hexagon_Debug_dynamic_toolv83_v60/pmu_stats.txt
</pre><left><img src="images/capi_v2_gain_sim_args.png"></left><p>
To specify the program arguments, click on the <code>Arguments</code> tab in the dialog box and provide arguments as follows:
</p><pre>
-i  ../../data/wnoise_48k_stereo.raw -o ../../data/output_wnoise_48k_stereo.raw -c ../../data/gain.cfg
</pre><left><img src="images/capi_v2_gain_program_args.png"></left><p>
To execute the program, click on the <code>Run</code> button at the bottom of the dialog box.
</p><p>
For Run configuration, the goal is the have the final execution line same as we do it manually as run make in shell.
</p><p>
The dialog box closes and the following output (which includes the 'benchmark_q' output) is displayed in the console of the main IDE window.
</p><left><img src="images/capi_v2_gain_run_output.png"></left><h2>
<a name="Debug%20project."></a>Debug project.
</h2><p>
To configure the debug environment, right-click on the project in Project Explorer and choose <code>Debug As -&gt; Debug configuration</code>.
</p><p>
This command displays the <code>Debug Configurations</code> dialog box. Using the tabs in this dialog box you can configure the debugger, program arguments, and runtime environment.
</p><left><img src="images/capi_v2_gain_debug_configs.png"></left><p>
C/C++ Application for debug configuration is same as run configuration
</p><p>
you will see a error message &#8220;Multiple launchers available - select one to continue&#8221; on top of the debug wizard. Please click on &#8220;Select one ...&#8221;
</p><p>
A prompt will appear asking you to Select Preferred Launcher (This dialog won't appear if Run was performed previously)
</p><left><img src="images/capi_v2_gain_preferred_launcher.png"></left><p>
Click on <code>Use configuration specific settings</code> and then select <code>Standard Create LLDB Debug Process Launcher</code>
</p><p>
Arguments under Target tab are same as Simulator tab arguments in Run configuration.
</p><p>
Program Arguments under Arguments Tab are same as Program Arguments in Run configuration.
</p><p>
Click and Apply and Debug. You should be prompted now to open the Debug perspective, and click Yes. It should launch the executable and break at main(), as shown below.
</p><left><img src="images/capi_v2_gain_debug_view.png"></left><p>
The debug perspective enables you to perform debugging operations such as stepping, disassembly, setting breakpoints, viewing/modifying variables, and viewing registers.
</p><p>
For example, clicking on the Registers tab of the debug perspective displays the contents of the Hexagon processor registers.
</p><p>
If any debug-related information is not displayed, you can display it by choosing Show View from the Window menu.
</p><h3>
<a name="Command%20line%20based"></a>Command line based
</h3><p>
In command line based unit test framework, the library is built first and then unit tested using a single command.
</p><p>
As a reference example, capi_v2_gain is used. Please execute similar commands to test other CAPI_V2 examples.
</p><ul>
<li>
<p>
Instructions to test Dynamic Library :
</p><ol type="1">
<li>
<p>
Open a CLI shell and navigate to &lt;HEXAGON_SDK_ROOT&gt;\examples\voice\capi_v2_gain
</p><pre>cd &lt;HEXAGON_SDK_ROOT&gt;\examples\voice\capi_v2_gain
</pre>
</li><li>
<p>
Execute the following command to test Dynamic Library.
</p><p>
Target = hexagon ; Version = V5 ; Flavor = Debug ; Options = dynamic
</p><pre>make V=hexagon_Debug_dynamic_toolv81_v65 tree VERBOSE=1
</pre>
</li><li>
<p>
Verify the test to be passed
</p>
</li>
</ol>
</li>
</ul><p>
For more information on building using make.d, please refer <a href="../Environments_Build%20System.html">make.d</a> documentation.
</p><p>
NOTE : In command line based unit testing, input arguments to executable are hard coded in the unit test source file.
</p><p>
Also, for loading a dynamic library, &#8212;usefs flag is added to build system.
</p><p align="center" style="display:block;padding-top: 50px;">
  Copyright &#169; 2018 Qualcomm Technologies Inc. All rights reserved.

</p><a style="display:block;padding-bottom: 700px;"></a></div></div>
</body>
</html>
